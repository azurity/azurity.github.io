{"title":"xss总结","date":"2018-10-24","tags":["CTF"],"text":"<p>做了一下haozi的xss平台<br><a id=\"more\"></a></p>\n<h1 id=\"常用XSS攻击思路\"><a href=\"#常用XSS攻击思路\" class=\"headerlink\" title=\"常用XSS攻击思路\"></a>常用XSS攻击思路</h1><h2 id=\"可利用标签\"><a href=\"#可利用标签\" class=\"headerlink\" title=\"可利用标签:\"></a>可利用标签:</h2><ul>\n<li>script</li>\n<li>a</li>\n<li>button</li>\n<li>img(部分浏览器已禁用)</li>\n</ul>\n<h2 id=\"可利用属性\"><a href=\"#可利用属性\" class=\"headerlink\" title=\"可利用属性\"></a>可利用属性</h2><ul>\n<li>src</li>\n<li>href</li>\n<li>各种on事件</li>\n</ul>\n<p>更多标签属性参考<a href=\"https://www.leavesongs.com/PENETRATION/xss-collect.html\" target=\"_blank\" rel=\"noopener\">那些年我们没能bypass的xss filter[from wooyun] | 离别歌</a></p>\n<h2 id=\"各种过滤及保护绕过\"><a href=\"#各种过滤及保护绕过\" class=\"headerlink\" title=\"各种过滤及保护绕过\"></a>各种过滤及保护绕过</h2><h3 id=\"基础标签过滤\"><a href=\"#基础标签过滤\" class=\"headerlink\" title=\"基础标签过滤\"></a>基础标签过滤</h3><p>使用大小写/双写修饰绕过</p>\n<table>\n<thead>\n<tr>\n<th>过滤</th>\n<th>绕过</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>/&lt;\\/?script/g</code></td>\n<td><code>&lt;ScRiPt&gt;</code></td>\n</tr>\n<tr>\n<td><code>replace(/script/ig,&#39;&#39;)</code></td>\n<td><code>&lt;scrscriptipt&gt;</code></td>\n</tr>\n</tbody>\n</table>\n<h3 id=\"特殊字符实体编码\"><a href=\"#特殊字符实体编码\" class=\"headerlink\" title=\"特殊字符实体编码\"></a>特殊字符实体编码</h3><ul>\n<li>通过html自动解析方式绕过<br>利用属性值解决<br>如果仅可以事件属性可使用<code>on...=location=&quot;javascript:...&quot;</code>的方式，利用location绕过</li>\n<li>利用<code>&lt;svg&gt;</code>优先解码的特性绕过，<code>&lt;svg&gt;&lt;script&gt;...</code></li>\n</ul>\n<p>可能的过滤样例: <code>/[()]/g</code></p>\n<h3 id=\"全部字符大写化\"><a href=\"#全部字符大写化\" class=\"headerlink\" title=\"全部字符大写化\"></a>全部字符大写化</h3><p>直接实体编码</p>\n<h3 id=\"标签注释并过滤-gt\"><a href=\"#标签注释并过滤-gt\" class=\"headerlink\" title=\"标签注释并过滤--&gt;\"></a>标签注释并过滤<code>--&gt;</code></h3><p>可以使用<code>--!&gt;</code>代替<code>--&gt;</code>闭合标签</p>\n<h3 id=\"各种简单的长正则过滤\"><a href=\"#各种简单的长正则过滤\" class=\"headerlink\" title=\"各种简单的长正则过滤\"></a>各种简单的长正则过滤</h3><p>直接回车绕过，html标签中回车会被忽略</p>\n<p>可能的过滤样例: <code>/auto|on.*=|&gt;/ig</code></p>\n<h2 id=\"完整标签过滤-lt-script-gt-gi\"><a href=\"#完整标签过滤-lt-script-gt-gi\" class=\"headerlink\" title=\"完整标签过滤/&lt;\\/?script&gt;/gi\"></a>完整标签过滤<code>/&lt;\\/?script&gt;/gi</code></h2><p>加个空格，<code>&lt;script &gt;</code></p>\n<h3 id=\"完整标签过滤-lt-gt-gt-gi\"><a href=\"#完整标签过滤-lt-gt-gt-gi\" class=\"headerlink\" title=\"完整标签过滤/&lt;\\/?[^&gt;]+&gt;/gi\"></a>完整标签过滤<code>/&lt;\\/?[^&gt;]+&gt;/gi</code></h3><p>使用不完整body标签绕过<br>body不完整也可加载<br><code>&lt;body ...</code></p>\n<h3 id=\"强制地址域名\"><a href=\"#强制地址域名\" class=\"headerlink\" title=\"强制地址域名\"></a>强制地址域名</h3><p>利用<code>@</code>特性转到任意域名</p>\n<h3 id=\"script标签内部xss\"><a href=\"#script标签内部xss\" class=\"headerlink\" title=\"script标签内部xss\"></a><code>script</code>标签内部xss</h3><p>直接结束<code>script</code>标签开启新<code>script</code>段，如果无法结束，可使用<code>--&gt;</code>结束一切标签</p>\n<h3 id=\"console-包裹\"><a href=\"#console-包裹\" class=\"headerlink\" title=\"console.*包裹\"></a>console.*包裹</h3><p>越出引号，利用console输出可任意参数，执行代码<br><code>console.log(&#39;&#39;,alert(&#39;xss&#39;),&#39;&#39;)</code></p>\n<h3 id=\"标签过滤-全部字符大-小-写化\"><a href=\"#标签过滤-全部字符大-小-写化\" class=\"headerlink\" title=\"标签过滤+全部字符大(小)写化\"></a>标签过滤+全部字符大(小)写化</h3><p>神奇的异体英文字母！小(大)写不同，大(小)写相同！<br><a href=\"https://en.wikipedia.org/wiki/Category:Uncommon_Latin_letters\" target=\"_blank\" rel=\"noopener\">非常见拉丁字母 - wikipedia</a><br>其中已发现可用：</p>\n<ul>\n<li><a href=\"https://en.wikipedia.org/wiki/%C9%AA\" target=\"_blank\" rel=\"noopener\">ɪ - Wikipedia</a>大写化为I</li>\n<li><a href=\"https://en.wikipedia.org/wiki/Long_s\" target=\"_blank\" rel=\"noopener\">Long s - Wikipedia</a>大写化为S</li>\n<li><code>u212A</code>小写化为k<blockquote>\n<p><a href=\"https://www.leavesongs.com/HTML/javascript-up-low-ercase-tip.html\" target=\"_blank\" rel=\"noopener\">Fuzz中的javascript大小写特性 | 离别歌</a></p>\n</blockquote>\n</li>\n</ul>\n<h2 id=\"参考\"><a href=\"#参考\" class=\"headerlink\" title=\"参考\"></a>参考</h2><ul>\n<li><a href=\"https://xss.haozi.me/\" target=\"_blank\" rel=\"noopener\">haozi - alert(1)</a></li>\n</ul>\n"}